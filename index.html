<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>AI Assistant</title>

  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap"
  />

  <style>
    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      margin: 0;
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, #ffe6f0, #f3e8ff);
      height: 100dvh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 12px;
    }

    .shell {
      width: 100%;
      max-width: 420px;
      height: 100%;
      max-height: 720px;
      background: rgba(255, 255, 255, 0.75);
      backdrop-filter: blur(18px);
      border-radius: 24px;
      box-shadow: 0 20px 45px rgba(255, 105, 180, 0.25);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      padding: 14px;
    }

    .top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 8px;
    }

    .title {
      font-size: 20px;
      font-weight: 600;
      color: #ff4f9a;
    }

    .badge {
      padding: 6px 12px;
      border-radius: 999px;
      background: rgba(255, 105, 180, 0.15);
      font-size: 13px;
      color: #ff4f9a;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #ff85c1;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }

    .messages {
      flex: 1;
      overflow-y: auto;
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      background: rgba(255, 255, 255, 0.3);
      border-radius: 16px;
      scroll-behavior: smooth;
    }

    /* Scrollbar */
    .messages {
      scrollbar-width: thin;
      scrollbar-color: #ff85c1 transparent;
    }

    .messages::-webkit-scrollbar {
      width: 6px;
    }

    .messages::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #ff85c1, #ff4f9a);
      border-radius: 10px;
    }

    .msg {
      max-width: 80%;
      padding: 12px 16px;
      border-radius: 20px;
      font-size: 14px;
      line-height: 1.0;
      animation: pop 0.25s ease-in-out;
      word-wrap: break-word;
    }

    .msg strong {
      font-weight: 600;
      color: #ff4f9a;
    }

    .user {
      background: linear-gradient(135deg, #ff85c1, #ffb3d9);
      color: white;
      margin-left: auto;
    }

    .assistant {
      background: linear-gradient(135deg, #f3e8ff, #e9d5ff);
      color: #5a2d82;
      margin-right: auto;
    }

    @keyframes pop {
      from { transform: scale(0.95); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .input-row {
      display: flex;
      gap: 8px;
      margin-top: 10px;
    }

    input {
      flex: 1;
      padding: 14px;
      border-radius: 20px;
      border: none;
      outline: none;
      background: #fff0f7;
      font-size: 15px;
    }

    button {
      padding: 14px 18px;
      border-radius: 20px;
      border: none;
      background: linear-gradient(135deg, #ff4f9a, #ff85c1);
      color: white;
      font-weight: 600;
      cursor: pointer;
    }

    .footer {
      text-align: center;
      font-size: 12px;
      margin-top: 6px;
      color: #ff85c1;
    }
  </style>
</head>

<body>
  <div class="shell">
    <div class="top">
      <div class="title">AI Assistant ü§ç</div>
      <div class="badge"><span class="status-dot"></span>Online</div>
    </div>

    <div id="messages" class="messages"></div>

    <div class="input-row">
      <input id="userInput" type="text" placeholder="Talk to me..." />
      <button onclick="sendMessage()">Send</button>
    </div>

    <div class="footer">¬© 2025 Evanns Test AI</div>
  </div>

  <script>
    const API_KEY = "7JBgvpSYcTw9dzuJ2blIKCkIwR14B9X1JTeMewll707pf16b0tOnJQQJ99BLACHYHv6XJ3w3AAAAACOG7dpX";
    const MODEL_NAME = "xmasforher";
    const ENDPOINT = "https://xmastest-resource.openai.azure.com/openai/v1/chat/completions";

    const messagesDiv = document.getElementById("messages");
    const userInput = document.getElementById("userInput");

    function cleanAssistantText(text) {
      return text
        .replace(/‚Ä¢/g, "")
        .replace(/-\s+/g, "")
        .replace(/\n{3,}/g, "\n\n")
        .replace(/You can talk to me about:/gi, "")
        .trim();
    }

    function formatAssistantText(text) {
      return cleanAssistantText(text)
        // Bold **text**
        .replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>")
        // Line breaks
        .replace(/\n/g, "<br><br>");
    }

    function appendMessage(text, role) {
      const div = document.createElement("div");
      div.className = "msg " + role;

      if (role === "assistant") {
        div.innerHTML = formatAssistantText(text);
      } else {
        div.textContent = text;
      }

      messagesDiv.appendChild(div);
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }

    async function sendMessage() {
      const text = userInput.value.trim();
      if (!text) return;

      userInput.value = "";
      appendMessage(text, "user");

      const payload = {
        model: MODEL_NAME,
        messages: [
          {
            role: "system",
            content:
              " You must be a specialist in periods, menstrual cycle. when someone says her menstrual time periods you must step by step help with precautions before periods and also on her periods. if shes having not normal symptoms get her practical solutions. Also if she give you her period dates remind her on those days. You might be talking to a girl with periods so make it gentle and clear and understanding.make the responses more clean and arranged, make it line by line where ever neceassary.  Use **bold** only when helpful. Speak like a caring friend."
          },
          { role: "user", content: text }
        ]
      };

      try {
        const response = await fetch(ENDPOINT, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "api-key": API_KEY
          },
          body: JSON.stringify(payload)
        });

        const data = await response.json();
        const reply = data.choices[0].message.content;
        appendMessage(reply, "assistant");

      } catch (err) {
        appendMessage("Something went wrong ü§ç Please try again.", "assistant");
      }
    }

    userInput.addEventListener("keydown", e => {
      if (e.key === "Enter") sendMessage();
    });
  </script>
</body>
</html>
